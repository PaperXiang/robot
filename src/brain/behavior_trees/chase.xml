<!-- 用于演示追球 -->

<root BTCPP_format="4" >
    <include path="./subtrees/subtree_cam_find_and_track_ball.xml" />

     <BehaviorTree ID="MainTree">
        <Sequence name="root">
            <ReactiveSequence>
               <SubTree ID="CamFindAndTrackBall" _autoremap="true" _while="control_state>=2" />
               <Sequence _while="control_state==3" >
                  <Sequence _while="!ball_location_known" >
                     <PlaySound sound="search" />
                     <Fallback>
                        <!-- 八字扫描 + 慢速身体旋转 -->
                        <ReactiveSequence>
                           <CamLissajousScan />
                           <RobotFindBall vyaw_limit="0.8" />
                        </ReactiveSequence>
                        <!-- 阶段2: 返回Ready位置 -->
                        <Sequence>
                           <GoToReadyPosition vx_limit="0.7" />
                           <Sleep msec="2000" />
                        </Sequence>
                     </Fallback>
                  </Sequence>
                  <Sequence _while="ball_location_known" >
                     <SimpleChase  stop_dist="1.0" stop_angle="0.3" />
                     <PlaySound sound="playful" _while="ball_range>=1.5" />
                     <PlaySound sound="exited" _while="ball_range<1.0" />
                  </Sequence>
               </Sequence>
            </ReactiveSequence>
        </Sequence>
     </BehaviorTree>
</root>
